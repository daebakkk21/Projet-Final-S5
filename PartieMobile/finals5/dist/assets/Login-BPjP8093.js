import{g as z,r as A,d as q}from"./firebase-RQfAkDXS.js";import{d as H,c as h,w as a,u as t,I as D,a as s,b as P,e as G,f as M,g as U,h as f,i as j,j as n,k as p,l as F,m as E,n as S,o as O,p as J,q as $,r as T,s as K,t as Q,v as W,x as L,y as X,z as Y,A as Z,B as ee,C as te,D as oe,E as v,F as se,G as y,_ as le}from"./index-x2tkpoM1.js";const ne={class:"login-container"},ae={class:"login-header"},ue={class:"logo-icon"},ie={class:"form-section"},re={class:"input-group"},ce={class:"input-group"},de={key:0,class:"error-message"},pe={class:"actions-section"},me={class:"action-buttons"},fe={key:0},ve={class:"help-section"},ge=H({__name:"Login",setup(Ie){const I=v(""),_=v(""),m=v(!1),u=v(""),k=v(null),C=v(null),w=se(),b=o=>{if(!o)return null;try{const e=o.shadowRoot,l=e&&e.querySelector("input")||o.querySelector&&o.querySelector("input")||null;return l?l.value:null}catch(e){return null}},x=o=>{var i,c,d,r,g;const e=(r=(d=(i=o==null?void 0:o.detail)==null?void 0:i.value)!=null?d:(c=o==null?void 0:o.target)==null?void 0:c.value)!=null?r:"",l=(g=b(k.value))!=null?g:"";I.value=e||l},B=o=>{var i,c,d,r,g;const e=(r=(d=(i=o==null?void 0:o.detail)==null?void 0:i.value)!=null?d:(c=o==null?void 0:o.target)==null?void 0:c.value)!=null?r:"",l=(g=b(C.value))!=null?g:"";_.value=e||l},V=()=>{w.push("/register")},N=()=>{w.push("/home")},R=async()=>{u.value="",m.value=!0,typeof document<"u"&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();const o=(I.value||b(k.value)||"").trim(),e=_.value||b(C.value)||"";if(!o||!e){u.value="Veuillez saisir l'email et le mot de passe.",m.value=!1;return}try{const l=await z(A(q,"clients"));if(!l.exists()){u.value="Aucun client trouvé",m.value=!1;return}let i=null;l.forEach(c=>{const d=c.key,r=c.val();r&&r.email===o&&e===d&&(i={id:d,...r})}),i?(localStorage.setItem("client",JSON.stringify(i)),console.log("Login: connectedClient",i),w.replace({name:"Acceuil"}).catch(()=>{})):u.value="Email ou mot de passe incorrect"}catch(l){console.error("Login (RTDB) error:",l),u.value=(l==null?void 0:l.message)||"Erreur lors de la connexion."}finally{m.value=!1}};return(o,e)=>(y(),h(t(D),null,{default:a(()=>[s(t(j),null,{default:a(()=>[s(t(P),{class:"custom-toolbar"},{default:a(()=>[s(t(G),{slot:"start"},{default:a(()=>[s(t(M),{defaultHref:"/home",text:"Retour",class:"custom-back-button"})]),_:1}),s(t(U),{class:"page-title"},{default:a(()=>[...e[2]||(e[2]=[f("Connexion",-1)])]),_:1})]),_:1})]),_:1}),s(t(oe),{class:"ion-padding"},{default:a(()=>[n("div",ne,[n("div",ae,[n("div",ue,[s(t(p),{icon:t(F)},null,8,["icon"])]),e[3]||(e[3]=n("h1",{class:"welcome-title"},"Bon retour !",-1)),e[4]||(e[4]=n("p",{class:"welcome-subtitle"},"Connectez-vous à votre compte Garage Elite",-1))]),n("div",ie,[n("div",re,[s(t(E),{class:"input-label"},{default:a(()=>[...e[5]||(e[5]=[f("Adresse email",-1)])]),_:1}),s(t(S),{ref_key:"emailInput",ref:k,value:I.value,"onUpdate:value":e[0]||(e[0]=l=>I.value=l),type:"email",onIonInput:x,onInput:x,placeholder:"exemple@email.com",class:O(["custom-input",{"has-error":u.value&&u.value.includes("email")}])},{default:a(()=>[s(t(p),{icon:t(J),slot:"start"},null,8,["icon"])]),_:1},8,["value","class"])]),n("div",ce,[s(t(E),{class:"input-label"},{default:a(()=>[...e[6]||(e[6]=[f("Mot de passe",-1)])]),_:1}),s(t(S),{ref_key:"passwordInput",ref:C,value:_.value,"onUpdate:value":e[1]||(e[1]=l=>_.value=l),type:"password",onIonInput:B,onInput:B,placeholder:"Votre mot de passe",class:O(["custom-input",{"has-error":u.value&&u.value.includes("password")}])},{default:a(()=>[s(t(p),{icon:t($),slot:"start"},null,8,["icon"])]),_:1},8,["value","class"])]),u.value?(y(),T("div",de,[s(t(p),{icon:t(K)},null,8,["icon"]),n("span",null,Q(u.value),1)])):W("",!0),n("div",pe,[n("div",me,[s(t(L),{expand:"block",onClick:R,disabled:m.value,class:"primary-btn"},{default:a(()=>[m.value?(y(),h(t(Y),{key:1,name:"crescent"})):(y(),T("span",fe,[s(t(p),{icon:t(X),slot:"start"},null,8,["icon"]),e[7]||(e[7]=f(" Se connecter ",-1))]))]),_:1},8,["disabled"]),s(t(L),{expand:"block",onClick:V,class:"secondary-btn"},{default:a(()=>[s(t(p),{icon:t(Z),slot:"start"},null,8,["icon"]),e[8]||(e[8]=f(" Créer un compte ",-1))]),_:1}),n("button",{onClick:N,class:"home-link"},[s(t(p),{icon:t(ee)},null,8,["icon"]),e[9]||(e[9]=f(" Retour à l'accueil ",-1))])])])]),n("div",ve,[s(t(te),{color:"medium"},{default:a(()=>[...e[10]||(e[10]=[n("small",null,"Besoin d'aide ? Contactez-nous au support@garageelite.fr",-1)])]),_:1})])])]),_:1})]),_:1}))}}),ye=le(ge,[["__scopeId","data-v-b82516ab"]]);export{ye as default};
