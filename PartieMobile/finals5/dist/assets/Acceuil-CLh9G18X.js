import{d as B,S as L,c as w,w as O,u as i,I as V,F as P,E as m,a as r,j as s,r as o,z as D,k as d,T as j,U as p,V as f,W as z,D as F,R as y,G as a,X as k,t as c,_ as G}from"./index-x2tkpoM1.js";import{g as N,r as T,d as J}from"./firebase-RQfAkDXS.js";const M={class:"dashboard-container"},U={key:0,class:"loading-state"},W={class:"add-car-section"},X={class:"cars-list-section"},$={class:"status-group"},q={key:0,class:"cars-group"},H={class:"car-header"},K={class:"car-icon"},Q={class:"car-info"},Y={class:"car-name"},Z={class:"car-description"},ss={class:"car-date"},ts={key:1,class:"empty-state"},es={class:"status-group"},as={key:0,class:"cars-group"},ns={class:"car-header"},os={class:"car-icon"},is={class:"car-info"},cs={class:"car-name"},rs={class:"car-description"},ls={class:"car-date"},ds={key:1,class:"empty-state"},us={class:"status-group"},_s={key:0,class:"cars-group"},ps={class:"car-header"},vs={class:"car-icon"},hs={class:"car-info"},gs={class:"car-name"},ms={class:"car-description"},fs={class:"car-date"},ys={key:1,class:"empty-state"},ks={class:"logout-section"},bs=["disabled"],Is={key:0},As=B({__name:"Acceuil",setup(Cs){const v=P(),u=m(!1),_=m([]),b=m(!0),h=n=>{try{return new Date(n).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}catch(t){return n}};L(async()=>{try{const n=localStorage.getItem("client");if(!n){await v.push("/login");return}let t;try{t=JSON.parse(n).id}catch(g){console.error("Erreur: données de session invalides");return}const e=await N(T(J,"voitures"));if(e.exists()){const g=e.val(),S=Object.entries(g).filter(([E,l])=>l.client_uid===t).map(([E,l])=>({id:E,immatriculation:l.immatriculation,description:l.description,statut_id:l.statut_id,date_depot:l.date_depot}));_.value=S,console.log("Voitures chargées:",S)}}catch(n){console.error("Erreur lors du chargement des voitures:",n)}finally{b.value=!1}});const I=y(()=>_.value.filter(n=>n.statut_id==="enAttente")),A=y(()=>_.value.filter(n=>n.statut_id==="enReparation")),C=y(()=>_.value.filter(n=>n.statut_id==="prete")),R=()=>{v.push({name:"AddCar"})},x=async()=>{u.value=!0;try{localStorage.removeItem("client"),await v.replace({name:"Login"})}catch(n){console.error("Sign out failed:",n)}finally{u.value=!1}};return(n,t)=>(a(),w(i(V),null,{default:O(()=>[r(i(F),{class:"ion-padding"},{default:O(()=>[s("div",M,[t[5]||(t[5]=s("div",{class:"header-section"},[s("h1",{class:"page-title"},"Accueil"),s("p",{class:"header-subtitle"},"Tableau de bord")],-1)),t[6]||(t[6]=s("div",{class:"welcome-message"},[s("p",null,"Bienvenue sur Garage Elite. Gérez vos véhicules et suivez vos réparations en temps réel.")],-1)),b.value?(a(),o("div",U,[r(i(D),{name:"dots"}),t[0]||(t[0]=s("p",null,"Chargement de vos voitures...",-1))])):(a(),o(p,{key:1},[s("div",W,[s("button",{onClick:R,class:"add-car-btn"},[r(i(d),{icon:i(j),class:"btn-icon"},null,8,["icon"]),t[1]||(t[1]=s("span",null,"Ajouter une voiture",-1))])]),s("div",X,[s("div",$,[t[2]||(t[2]=s("h2",{class:"status-title"},[s("span",{class:"status-badge pending"},"En attente")],-1)),I.value.length>0?(a(),o("div",q,[(a(!0),o(p,null,f(I.value,e=>(a(),o("div",{key:e.id,class:"car-card pending-card"},[s("div",H,[s("div",K,[r(i(d),{icon:i(k)},null,8,["icon"])]),s("div",Q,[s("h3",Y,c(e.immatriculation),1),s("p",Z,c(e.description),1)])]),s("p",ss,"Depuis le "+c(h(e.date_depot)),1)]))),128))])):(a(),o("p",ts,"Aucune voiture en attente"))]),s("div",es,[t[3]||(t[3]=s("h2",{class:"status-title"},[s("span",{class:"status-badge repairing"},"En reparation")],-1)),A.value.length>0?(a(),o("div",as,[(a(!0),o(p,null,f(A.value,e=>(a(),o("div",{key:e.id,class:"car-card repairing-card"},[s("div",ns,[s("div",os,[r(i(d),{icon:i(k)},null,8,["icon"])]),s("div",is,[s("h3",cs,c(e.immatriculation),1),s("p",rs,c(e.description),1)])]),s("p",ls,"En cours depuis le "+c(h(e.date_depot)),1)]))),128))])):(a(),o("p",ds,"Aucune voiture en réparation"))]),s("div",us,[t[4]||(t[4]=s("h2",{class:"status-title"},[s("span",{class:"status-badge ready"},"Prête")],-1)),C.value.length>0?(a(),o("div",_s,[(a(!0),o(p,null,f(C.value,e=>(a(),o("div",{key:e.id,class:"car-card ready-card"},[s("div",ps,[s("div",vs,[r(i(d),{icon:i(k)},null,8,["icon"])]),s("div",hs,[s("h3",gs,c(e.immatriculation),1),s("p",ms,c(e.description),1)])]),s("p",fs,"Prête depuis le "+c(h(e.date_depot)),1)]))),128))])):(a(),o("p",ys,"Aucune voiture prête"))])])],64)),s("div",ks,[s("button",{onClick:x,disabled:u.value,class:"logout-btn"},[r(i(d),{icon:i(z),class:"btn-icon"},null,8,["icon"]),u.value?(a(),w(i(D),{key:1,name:"dots"})):(a(),o("span",Is,"Se déconnecter"))],8,bs)])])]),_:1})]),_:1}))}}),ws=G(As,[["__scopeId","data-v-f9f6a5c4"]]);export{ws as default};
