import{s as R,a as T}from"./firebase-BfoIeN5G.js";import{d as q,c as E,w as l,u as t,I as z,a as o,b as D,e as P,f as H,g as M,h as I,i as F,j as r,k as u,l as U,m as L,n as S,o as V,p as j,q as G,r as A,s as W,t as J,v as K,x as b,y as Q,z as X,A as Y,B as Z,C as $,D as i,E as ee,F as k,_ as te}from"./index-DTOPIIQY.js";const ae={class:"login-container"},oe={class:"login-header"},se={class:"logo-icon"},le={class:"form-section"},ne={class:"input-group"},re={class:"input-group"},ue={key:0,class:"error-message"},ie={class:"buttons-container"},ce={key:0},de={class:"help-section"},pe=q({__name:"Login",setup(me){const _=i(""),g=i(""),c=i(!1),n=i(""),w=i(null),h=i(null),C=ee(),y=a=>{if(!a)return null;try{const e=a.shadowRoot,s=e&&e.querySelector("input")||a.querySelector&&a.querySelector("input")||null;return s?s.value:null}catch(e){return null}},x=a=>{var d,p,m,f,v;const e=(f=(m=(d=a==null?void 0:a.detail)==null?void 0:d.value)!=null?m:(p=a==null?void 0:a.target)==null?void 0:p.value)!=null?f:"",s=(v=y(w.value))!=null?v:"";_.value=e||s},B=a=>{var d,p,m,f,v;const e=(f=(m=(d=a==null?void 0:a.detail)==null?void 0:d.value)!=null?m:(p=a==null?void 0:a.target)==null?void 0:p.value)!=null?f:"",s=(v=y(h.value))!=null?v:"";g.value=e||s},N=async()=>{n.value="",c.value=!0,typeof document<"u"&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();const a=(_.value||y(w.value)||"").trim(),e=g.value||y(h.value)||"";if(!a||!e){n.value="Veuillez saisir l'email et le mot de passe.",c.value=!1;return}try{const s=await R(T,a,e);await C.replace({name:"Acceuil"})}catch(s){console.error("Login error:",s),s.code==="auth/invalid-email"?n.value="Email invalide.":s.code==="auth/user-not-found"?n.value="Aucun compte trouvé pour cet email.":s.code==="auth/wrong-password"?n.value="Mot de passe incorrect.":s.code==="auth/too-many-requests"?n.value="Trop de tentatives. Réessayer plus tard.":n.value=s.message||"Erreur lors de la connexion."}finally{c.value=!1}},O=async()=>{try{await C.push({name:"Register"})}catch(a){console.error("Navigation to /register failed:",a),C.push("/register").catch(e=>console.error("Fallback push failed:",e))}};return(a,e)=>(k(),E(t(z),null,{default:l(()=>[o(t(F),null,{default:l(()=>[o(t(D),null,{default:l(()=>[o(t(P),{slot:"start"},{default:l(()=>[o(t(H),{defaultHref:"/home",text:"Retour"})]),_:1}),o(t(M),null,{default:l(()=>[...e[2]||(e[2]=[I("Connexion",-1)])]),_:1})]),_:1})]),_:1}),o(t($),{class:"ion-padding"},{default:l(()=>[r("div",ae,[r("div",oe,[r("div",se,[o(t(u),{icon:t(U)},null,8,["icon"])]),e[3]||(e[3]=r("h1",{class:"welcome-title"},"Bon retour !",-1)),e[4]||(e[4]=r("p",{class:"welcome-subtitle"},"Connectez-vous à votre compte Garage Elite",-1))]),r("div",le,[r("div",ne,[o(t(L),{class:"input-label"},{default:l(()=>[...e[5]||(e[5]=[I("Adresse email",-1)])]),_:1}),o(t(S),{ref_key:"emailInput",ref:w,value:_.value,"onUpdate:value":e[0]||(e[0]=s=>_.value=s),type:"email",onIonInput:x,onInput:x,placeholder:"exemple@email.com",class:V(["custom-input",{"has-error":n.value&&n.value.includes("email")}])},{default:l(()=>[o(t(u),{icon:t(j),slot:"start"},null,8,["icon"])]),_:1},8,["value","class"])]),r("div",re,[o(t(L),{class:"input-label"},{default:l(()=>[...e[6]||(e[6]=[I("Mot de passe",-1)])]),_:1}),o(t(S),{ref_key:"passwordInput",ref:h,value:g.value,"onUpdate:value":e[1]||(e[1]=s=>g.value=s),type:"password",onIonInput:B,onInput:B,placeholder:"Votre mot de passe",class:V(["custom-input",{"has-error":n.value&&n.value.includes("password")}])},{default:l(()=>[o(t(u),{icon:t(G),slot:"start"},null,8,["icon"])]),_:1},8,["value","class"])]),n.value?(k(),A("div",ue,[o(t(u),{icon:t(W)},null,8,["icon"]),r("span",null,J(n.value),1)])):K("",!0),r("div",ie,[o(t(b),{expand:"block",onClick:N,disabled:c.value,color:"success",class:"primary-btn"},{default:l(()=>[c.value?(k(),E(t(Q),{key:1,name:"crescent"})):(k(),A("span",ce,"Se connecter"))]),_:1},8,["disabled"]),o(t(b),{fill:"clear",routerLink:"/register",routerDirection:"forward",onClick:O,class:"secondary-link"},{default:l(()=>[o(t(u),{icon:t(X),slot:"start"},null,8,["icon"]),e[7]||(e[7]=I(" Créer un compte ",-1))]),_:1}),o(t(b),{fill:"clear",routerLink:"/home",routerDirection:"back",class:"home-link"},{default:l(()=>[o(t(u),{icon:t(Y),slot:"start"},null,8,["icon"]),e[8]||(e[8]=I(" Retour à l'accueil ",-1))]),_:1})])]),r("div",de,[o(t(Z),{color:"medium"},{default:l(()=>[...e[9]||(e[9]=[r("small",null,"Besoin d'aide ? Contactez-nous au support@autocare.fr",-1)])]),_:1})])])]),_:1})]),_:1}))}}),Ie=te(pe,[["__scopeId","data-v-89c6805d"]]);export{Ie as default};
